# ストレージの実験

pi41のみ、SSDで起動しているので、データベースなどのPodをpi41のみで起動するようにし、保存ファイルをすべてSSDに集めるみたいなことをしたい。

## localとnodeAffinityを使う

PersistentVolumeのlocalという要素で、ホストマシンのディレクトリをk8sで使えるストレージ化できるようだ。localを使う条件として、nodeAffinityという要素で、どのノードでストレージを使えるのかという制約を決める必要がある。今回でいえばここにpi41と指定すれば、このPersistentVolumeを使うPodはすべてpi41にデプロイされるという感じになるっぽい。

参考とした記事: https://qiita.com/sotoiwa/items/09d2f43a35025e7be782#local

## nginxをデプロイしてみた

ストレージ内に適当なindex.htmlを作成し、マウントしてnginxをデプロイしてみたところうまいことマウントできていた。さらにコンテナ内に入り込んでファイルを書き換えてみたところ、書き込みは成功し、ホスト側のファイルシステムにも無事反映されていた。ということでdocker-composeのvolumeのように使えることがわかった。
